/**
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @see https://github.com/google/transmat
 * @see https://google.github.io/transmat/
 * @see https://web.dev/datatransfer/
 *
 * minified with https://www.toptal.com/developers/javascript-minifier
 */
!function(b,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define(a):(b="undefined"!=typeof globalThis?globalThis:b||self).transmat=a()}(this,function(){"use strict";function a(b){var a={exports:{}};return b(a,a.exports),a.exports}var b,c=a(function(b,a){Object.defineProperty(a,"__esModule",{value:!0}),a.setMinimalDragImage=a.normalizeType=a.getDataTransfer=void 0,a.getDataTransfer=function(b){var a;let c=null!==(a=b.clipboardData)&& void 0!==a?a:b.dataTransfer;if(!c)throw new Error("No DataTransfer available at this event.");return c},a.normalizeType=function(b){let a=b.toLowerCase();switch(a){case"text":return"text/plain";case"url":return"text/uri-list";default:return a}},a.setMinimalDragImage=function(i,c=22,d=18,a=2,e=4,j="rgba(255,255,255,.5)",k="rgba(0,0,0,.5)"){let b=document.createElement("canvas");b.width=c,b.height=d;let h=b.getContext("2d");for(let f=0;f<c/a;f++)for(let g=0;g<d/a;g++)h.fillStyle=(f+g)%2?j:k,h.fillRect(f*a,g*a,a,a);h.clearRect(e,e,c-2*e,d-2*e),Object.assign(b.style,{width:`${c}px`,height:`${d}}px`,position:"absolute",left:"-999px"}),document.body.appendChild(b),i.setDragImage(b,c/2,d/2),setTimeout(()=>{b.remove()})}}),d=a(function(b,a){Object.defineProperty(a,"__esModule",{value:!0}),a.match=a.parse=void 0,a.parse=function(d){let[e,...f]=d.trim().toLowerCase().split(";"),[a,b]=e.split("/");if(!a||!b)throw new Error("Invalid mime type. Missing type or subtype.");let c=new Map;for(let g of f){let[h,...i]=g.split("=");c.set(h,i.join("="))}return{type:a,subtype:b,params:c}},a.match=function(a,b){for(let c of[...a.params.keys()])if(a.params.get(c)!==b.params.get(c))return!1;return a.type===b.type&&a.subtype===b.subtype}}),e=a(function(c,a){function b(a,b,c,d){for(let e of b)a.removeEventListener(e,c,d)}Object.defineProperty(a,"__esModule",{value:!0}),a.removeEventListeners=a.addEventListeners=void 0,a.addEventListeners=function(a,c,d,e){for(let f of c)a.addEventListener(f,d,e);return()=>{b(a,c,d,e)}},a.removeEventListeners=b}),f=a(function(b,a){Object.defineProperty(a,"__esModule",{value:!0}),a.addListeners=a.Transmat=void 0,a.Transmat=class{constructor(a){this.event=a,this.dataTransfer=c.getDataTransfer(a)}accept(a){return"dragover"===this.event.type&&(a&&(this.dataTransfer.dropEffect=a),this.event.preventDefault()),"drop"===this.event.type&&this.event.preventDefault(),"drop"===this.event.type||"paste"===this.event.type}hasType(a){let b=c.normalizeType(a);return this.dataTransfer.types.some(e=>{let a=c.normalizeType(e);try{return d.match(d.parse(b),d.parse(a))}catch(f){return b===a}})}getData(a){return this.hasType(a)?this.dataTransfer.getData(c.normalizeType(a)):void 0}setData(a,d){if("string"==typeof a)this.setData({[a]:d});else for(let[e,b]of Object.entries(a)){let f="object"==typeof b?JSON.stringify(b):`${b}`;this.dataTransfer.setData(c.normalizeType(e),f)}}},a.addListeners=function(a,d,k,b={dragDrop:!0,copyPaste:!0}){let c="transmit"===d,f,g;if(b.copyPaste){let h=c?["cut","copy"]:["paste"],i=a.parentElement;f=e.addEventListeners(i,h,b=>{a.contains(document.activeElement)&&(k(b,a),("copy"===b.type||"cut"===b.type)&&b.preventDefault())})}if(b.dragDrop){let j=c?["dragstart"]:["dragover","drop"];g=e.addEventListeners(a,j,b=>{k(b,a)})}return()=>{f&&f(),g&&g()}}}),g=a(function(b,a){Object.defineProperty(a,"__esModule",{value:!0}),a.TransmatObserver=void 0,a.TransmatObserver=class{constructor(a){this.callback=a,this.targets=new Set,this.prevRecords=[],this.removeEventListeners=()=>{},this.onTransferEvent=a=>{var c,d;let b=[];for(let e of this.targets){let g="dragleave"===a.type&&(a.target===document.body||a.target===document.body.parentElement),f="drop"!==a.type&&"dragend"!==a.type&&!g,h=e.contains(a.target),i=f&&h&&"dragover"===a.type;b.push({target:e,event:a,isActive:f,isTarget:i})}c=b,d=this.prevRecords,c.length===d.length&&c.every((a,c)=>{let b=d[c];return a.isActive===b.isActive&&a.isTarget===b.isTarget})||(this.prevRecords=b,this.callback(b,this))}}addEventListeners(){let a=this.onTransferEvent;this.removeEventListeners=e.addEventListeners(document,["dragover","dragend","dragleave","drop"],a,!0)}takeRecords(){return this.prevRecords}observe(a){this.targets.add(a),1===this.targets.size&&this.addEventListeners()}unobserve(a){this.targets.delete(a),0===this.targets.size&&this.removeEventListeners()}disconnect(){this.targets.clear(),this.removeEventListeners()}}});return(b=a(function(b,a){Object.defineProperty(a,"__esModule",{value:!0}),a.TransmatObserver=a.addListeners=a.Transmat=void 0,Object.defineProperty(a,"Transmat",{enumerable:!0,get:function(){return f.Transmat}}),Object.defineProperty(a,"addListeners",{enumerable:!0,get:function(){return f.addListeners}}),Object.defineProperty(a,"TransmatObserver",{enumerable:!0,get:function(){return g.TransmatObserver}})}))&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b})
